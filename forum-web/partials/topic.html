<section id="peelSplash" ng-if="hidePeelSplash === false">
  <div id="splashUnderlay">
    <div id="splashOverlay">
      <div class="graphicContainer">
        <img src="img/splash_graphic.png" id="splashGraphic"/>
      </div>
      <div class="graphicContainer">
        <img src="img/peel_join.png" id="continue" ng-click="continueToExperience()"/>
        <!-- <img src="img/kave_logo2.png" id="kaveLogo"/> -->
      </div>
    </div>
  </div>
</section>

<!-- <section id="xContent">
  <div id="xContentUnderlay" ng-click="backToChat()">
    <div id="xContentOverlay">
      <div id="backToChat" ng-click="backToChat()"><img src="img/backButton-2x.png" />Back To Live Chat</div>
      <div id="iframewrapper">
        <iframe frameborder="0" id="xSrc" name="xLinkFrame">
          
        </iframe>
      </div>
    </div>
  </div>
</section> -->

<section id="topicSection" ng-controller="SocialController as social">
  <nav class="navbar navbar-fixed-top" id="header">
    <div id="peelNavBar" ng-if="isPeelUser == true">
      <button class="btn-link peelButton" id="closePeelButton" ng-click="peelClose()"><img src="img/backButton-2x.png"/></button>
      <span id="peelText">Peel Bar</span>
      <button class="btn-link peelButton" id="peelWatchOnTVButton" ng-click="peelWatchOnTV()">Watch Channel</button>
    </div>
    <div class="scoreCardContent clearfix">

      <div id="rightColor">
        <svg 
        version="1.1"
        class="svg-content"
        x="0"
        y="0"
        width="100%"
        height="100%"
        viewBox="0 0 100 100"
        preserveAspectRatio="none">
        <polygon points="60,0 100,0 100,100 40,100"/>
      </svg>
    </div>

    <!-- Left Column -->
    <div id="L-40" class="grid-col grid-col-40">
      
      <!-- Top Row (Name & Record) -->
      <div class="grid-row-22">
        <span id="teamName">{{leftTeam.name}}</span>
        <span id="leftTeamRecord" ng-if="gameStatus === 'past' || gameStatus === 'future'"></span>
      </div>

      <!-- Middle Row (Logo & Score) -->
      <div class="grid-row-45">
        <span class="teamLogo" ng-class="{largeLogo: gameStatus === 'future'}"><img src={{leftTeam.logo}} /></span>

        <span class="score score-left" ng-if="leftTeamScore.length < 3 && rightTeamScore.length < 3" ng-hide="gameStatus === 'future'">{{leftTeamScore}}</span>
        <span class="triple triple-left" ng-if="leftTeamScore.length === 3 || rightTeamScore.length === 3" ng-hide="gameStatus === 'future'">{{leftTeamScore}}</span>
      </div>

      <!-- Bottom Row (Ball Possession) -->
      <div class="grid-row-33">
        <span id="possession" ng-if="gameStatus === 'live'"></span>
      </div>

    </div>

    <!-- Center Column -->
    <div class="grid-col grid-col-20">
      
      <!-- Top Row (Live OR VS) -->
      <div id="liveGameIndicator" class="grid-row-22">
        <span ng-if="gameStatus === 'live'"><img src="img/live-2x.png"/></span>
        <span id="vs" ng-if="gameStatus === 'future'">VS</span>
      </div>
      
      <!-- Middle Row (Current/Future Game Info) -->
      <div class="grid-row-45 time">
        <div class="center" ng-if="gameStatus === 'live'">
          <span>{{gamePeriod}}</span>
          <span>{{gameClock}}</span>
        </div>
        <div class="center" ng-if="gameStatus === 'future'">
          <span>{{gameScheduledTime.date}}</span>
          <span id="futureTime">{{gameScheduledTime.time}}</span>
        </div>
        <div class="center" ng-if="gameStatus === 'past'">
          <span id="finalDate">{{gameScheduledTime.date}}</span>
          <span id="final">
            <span>FINAL</span>
          </span>
        </div>
      </div>
      
      <!-- Bottom Row (All Scores Button) -->
      <div class="grid-row-33">
        <span><a id="allScoresLink" href="{{allScoresURL}}" target="_blank">
          <span id="allScoresSpan">{{allScoresTitle}}</span>
        </a></span>
      </div>

    </div>

    <!-- Right Column -->
    <div id="R-40" class="grid-col grid-col-40">
      
      <!-- Top Row (Name & Record) -->
      <div class="grid-row-22">
        <span id="rightTeamRecord" ng-if="gameStatus === 'past' || gameStatus === 'future'"></span>
        <span id="teamName">{{rightTeam.name}}</span>
      </div>
      
      <!-- Middle Row (Logo & Score) -->
      <div class="grid-row-45">

        <span class="score score-right" ng-if="rightTeamScore.length < 3 && leftTeamScore.length < 3" ng-hide="gameStatus === 'future'">{{rightTeamScore}}</span>
        <span class="triple triple-right" ng-if="rightTeamScore.length === 3 || leftTeamScore.length === 3" ng-hide="gameStatus === 'future'">{{rightTeamScore}}</span>
        
        <span class="teamLogo" ng-class="{largeLogo: gameStatus === 'future'}"><img src={{rightTeam.logo}} /></span>
      </div>
      
      <!-- Bottom Row (Ball Possession) -->
      <div class="grid-row-33">
        <span id="possession" ng-if="gameStatus === 'live'"></span>
      </div>
    </div>

  </div>
</nav>

<div id="topicDetails" class="row" style="width=40%"> 
  <div>
    <b>{{topicTitle}}</b>
  </div>
  <div id="topicDescriptionBody">
    {{topicDescHtml}}
  </div>
  <!-- <div id="topicImage">
    <img ng-src="{{topicMediaUrl}}" class="topicPhoto" ng-click="imageClick(topicMediaUrl);" />
  </div> -->    

  <div class="topicSharingButtonsRow clearfix">
    <div class="grid-col-alt grid-col-50">
      <div id="headLike">
        <button class="btn-link topic-social-btn" ng-click="updateLikeTopic()" ng-switch="liked">
          <img ng-switch-when="true" src="img/thumbsUp_select@2x.png"/> 
          <img ng-switch-when="false" src="img/thumbsUp@2x.png"/> 
        </button>
        <span class="socialButtonLabel fkFont">{{likesCount}} </span>
      </div>
    </div>
    <div class="grid-col-alt grid-col-50">
      <div id="headComment">
        <button class="btn-link topic-social-btn" ng-click="commentOnTopic()"><img src="img/comment-3x.png"/> 
        </button>
        <span class="socialButtonLabel fkFont">{{commentsCount}}</span>
      </div>
    </div>
    <!-- <div class="grid-col grid-col-33">
      <div id="headMore">
        <button id="moreButton" class="btn-link topic-social-btn" ng-click="moreOptions()"><img src="img/ellipsis@3x.png"/> 
        </button>
      </div>
    </div> -->
  </div>
</div>
<div id="inputControls">
  <div class="tabContainer clearfix">
    <div id="chatTab" class="grid-col grid-col-33 tab selectedTab" ng-click="switchTabs('chat')">
      <span class="tabName">Chat</span>
    </div>
    <div id="videoTab" class="grid-col grid-col-34 tab" ng-click="social.initFeed('video')">
      <span class="tabName">Video</span>
    </div>
    <div id="socialTab" class="grid-col grid-col-33 tab" ng-click="social.initFeed('social')">
      <span class="tabName">Social</span>
    </div>
  </div>

  <div id="textInputFieldTopic" class="clearfix" ng-if="activeTab === 'chat' && mobileBrowser === false" ng-controller="UserInputController as user">
    <div id="preview" ng-if="user.uploader.queue.length > 0">
      <button type="button" id="removeMedia" class="fkFont" ng-click="user.removeMedia()">X
      </button>
    </div>
    <div id="uploadControls" ng-if="user.uploader.isUploading && user.uploader.queue.length > 0">
        <div class="progress" style="margin-bottom: 0;">
          <div id="progress-bar" role="progressbar" ng-style="{ 'width': user.uploader.progress + '%' }"></div>
        </div>
    </div>
    <form id="postCommentForm" ng-submit="user.postComment(commentText, true)">
      <div id="postCommentDiv" class="input-group">
        <label for="fileUpload" id="attachMediaIcon">
          <img src="img/attach-media.png" />
        </label>

        <button id="postCommentButton" class="btn btn-default" type="button" ng-click="user.postComment(commentText, true)">Post</button>

        <span><input id="topicCommentField" type="text" class="form-control"
        placeholder="Write a comment..." ng-model="commentText" ng-focus="user.highlightPost()" ng-blur="user.unhighlightPost()"></span>

        <input id="fileUpload" filestyle="" type="file" data-button-text="Single" data-class-button="btn btn-default" data-class-input="form-control inline" nv-file-select="" uploader="user.uploader" class="form-control" />

      </div>
    </form>
    <div class="fileWarning" ng-if="user.fileMaxExceeded" ng-switch="user.mediaType">
      <span class="text-danger" ng-switch-when="image">Image Max Size Exceeded: Please ensure file is less than 5MB</span>
      <span class="text-danger" ng-switch-when="video">Video Max Size Exceeded: Please ensure file is less than 10MB</span>
    </div>
    <div class="fileWarning" ng-if="user.HTML5warning === true">
      <span class="text-danger">Please Use a Browser That Supports HTML5</span>
    </div>
  </div>
</div>

<div class="commentsContainer" ng-switch="activeTab">

  <div id="loadChatFill" ng-repeat="item in [1,2,3,4,5]" ng-if="loadingChat">
    <span class="load loadProfilePhoto"></span>
    <span class="loadPost">
      <div class="clearfix">
        <span class="load loadChatUsername"></span>
        <span class="load loadChatTimestamp"></span>
      </div>
      <div class="load loadChatBody"></div>
      <div class="load loadChatFooter"></div>
    </span>
  </div>

  <div id="loadChatFill" ng-repeat="item in [1,2,3,4,5]" ng-if="loadingSocial">
    <span class="load loadProfilePhoto"></span>
    <span class="loadPost">
      <div class="clearfix">
        <span class="load loadChatUsername"></span>
        <span class="load loadChatTimestamp"></span>
      </div>
      <div class="load loadSocialAlias"></div>
    </span>
    <div class="load loadSocialBody"></div>
  </div>

  <!-- Chat Tab Content -->
  <div ng-switch-when="chat" ng-repeat="thisPost in commentsArray track by $index" ng-switch="thisPost.mediaType" class="row postRow" id="{{$index}}" repeat-finished-notify>

    <span class="postAuthorPhoto">
      <div>
        <a class="thumbnail">
          <img ng-src="{{thisPost.postAuthorPhoto}}" alt="" onerror="this.src='img/default_user_v3.png'" class="userPhoto">
        </a>
      </div>
      <span id="pinIcon" ng-if="thisPost.pin == true">
        <img src="img/pin@3x.png"/>
      </span>
    </span>

    <span class="post">

      <div class="chatPostHeader">
        <span class="postUsername">
          {{thisPost.postAuthorName}}
        </span>
        <span class="chatTimestamp">
          {{thisPost.postTimestamp}}
        </span>
      </div>

      <div ng-bind-html="thisPost.html | linky" class="postContent">
        {{thisPost.html}} 
      </div>

      <div ng-switch-when="image">
        <img ng-src="{{thisPost.mediaUrl}}" class="postPhoto" ng-click="imageClick(thisPost.mediaUrl);" />
      </div>

      <!-- <div ng-switch-when="image" class="cropView" ng-style="{background:'url({{thisPost.mediaUrl}}) no-repeat','background-size':'cover','height':thisPost.mediaAspectFeed.h, 'margin-bottom':'15px'}" ng-click="imageClick(thisPost.mediaUrl)">
      </div> -->

      <div ng-switch-when="video">
        <video controls="controls" poster="{{thisPost.mediaThumbUrl}}" class="postVideo">
          <source ng-src="{{trustSrc(thisPost.mediaUrl)}}" type="video/mp4">
          </video>
      </div>  

      <div class="socialButtonsRow">
        <button id="chatLike" class="btn-link social-btn" ng-click="updateLikeComment(thisPost.id)" ng-switch="thisPost.isLiked">
          <img class="social-like" ng-switch-when="true" src="img/thumbsUp_select@2x.png"/> 
          <img class="social-like" ng-switch-when="false" src="img/thumbsUp@2x.png"/> 
          
        </button>
        <span class="socialButtonLable">{{thisPost.likeCount}}  </span>

        <button id="chatReply" class="btn-link social-btn" ng-click="goToRepliesWithKeyboardTriggered(thisPost.id)">
          <img class="social-reply" src="img/shareCopy@2x.png"/> </button>
          <span class="socialButtonLable"> Reply</span>
      </div>
      <div class="sharingButtonsRow">
        <div class="chatTimestamp">
          <button class="btn-link social-btn-more dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" ng-click="moreButtonTapped();">
            <img class="social-more" src="img/moreButton.png"/>
          </button>
          <ul class="dropdown-menu dropdown-menu-right" ng-switch="thisPost.isMyComment">

            <li ng-switch-when="true"><a ng-click="deleteComment(thisPost.id);">Delete Comment</a></li>
            <li ng-switch-when="false"><a ng-click="reportCommentAsSpam(thisPost.id);">Report as spam</a></li>
          </ul>
        </div>
      </div>
      <div class="moreRepliesContainer" ng-if="thisPost.replyCount === 1">
        {{thisPost.replyCount}} more Reply
      </div>
      <div class="moreRepliesContainer" ng-if="thisPost.replyCount > 1">
        {{thisPost.replyCount}} more Replies
      </div>
    </span>
    <!-- <div class="moreRepliesContainer" ng-if="thisPost.replyCount === 1">
      {{thisPost.replyCount}} more Reply
    </div>
    <div class="moreRepliesContainer" ng-if="thisPost.replyCount > 1">
      {{thisPost.replyCount}} more Replies
    </div> -->
  </div>

  <!-- Video Tab Content -->
  <div ng-switch-when="video" ng-repeat="thisPost in social.videoArray track by $index" ng-switch="thisPost.mediaType" class="row postRowAlt" id="{{$index}}" repeat-finished-notify>
    <div id="socialHeaderContainer">
      <span class="postAuthorPhoto">
        <span>
          <a class="thumbnail">
            <img ng-src="{{thisPost.postAuthorPhoto}}" alt="" onerror="this.src='img/default_user_v3.png'" class="userPhoto" />
          </a>
        </span>
        <span id="pinIcon" ng-if="thisPost.pin == true">
          <img src="img/pin.png" />
        </span>
      </span>
      <div id="socialHeader">
        <span class="socialPostUsername">
          {{thisPost.postAuthorName}}
        </span>
        <span class="timestamp">
          <img id="providerLogo" src="{{thisPost.providerLogo}}" />{{thisPost.postTimestamp}}
        </span>
      </div>
      <div class="socialAlias">
        @{{thisPost.postAuthorAlias}}
      </div>
    </div>
    <div class="socialContentContainer">
      <div ng-bind-html="thisPost.html | linky" class="postContent videoContent">
        <p>{{thisPost.html}}</p><br> 
      </div>
      <div ng-if="thisPost.embedPlayable === true" ng-bind-html="thisPost.embedHtml" class="postContent videoContent">
      </div>

      <div ng-switch-when="image" class="cropView ng-style:{ width: thisPost.mediaAspectFeed.w, height: thisPost.mediaAspectFeed.h, 'margin-bottom':'15px' };">
        <img ng-src="{{thisPost.mediaUrl}}" class="postPhotoSocial ng-style:{ bottom: thisPost.mediaAspectFeed.y }" ng-click="imageClick(thisPost.mediaUrl);" />
      </div>

      <div ng-switch-when="video" class="ng-style:{'margin-bottom':'15px'}">
        <video controls="controls" poster="{{thisPost.mediaThumbUrl}}" class="postVideo">
          <source ng-src="{{trustSrc(thisPost.mediaUrl)}}" type="video/mp4">
          </video>
      </div> 
    </div> 

    <div class="socialButtonsRow socialText">
      
      <button class="btn-link social-btn" ng-click="">
        <img class="social-metrics-reply" src="img/reply@2x.png"/>
      </button>
      <!-- <span class="socialButtonLable"> {{thisPost.replyCount}}</span> -->

      <button class="btn-link social-btn socialRetweet" ng-click="">
        <!-- <img class="social-metrics-retweet" ng-switch-when="true" src="img/retweet_select@2x.png"/>  -->
        <img class="social-metrics-retweet" src="img/retweet@2x.png" /> 
      </button>
      <span class="socialButtonLable">{{thisPost.retweetCount}}</span>

      <button class="btn-link social-btn socialFavorite" ng-click="">
        <!-- <img class="social-metrics-heart" ng-switch-when="true" src="img/heart_select@2x.png"/> --> 
        <img class="social-metrics-heart" src="img/heart@2x.png" /> 
      </button>
      <span class="socialButtonLable">{{thisPost.favoriteCount}}</span>

    </div>
  </div>

  <!-- Social Tab Content -->
  <div ng-switch-when="social" ng-repeat="thisPost in social.socialArray track by $index" ng-switch="thisPost.mediaType" class="row postRowAlt" id="{{$index}}" repeat-finished-notify>
    <div id="socialHeaderContainer">
      <span class="postAuthorPhoto">
        <span>
          <a class="thumbnail">
            <img ng-src="{{thisPost.postAuthorPhoto}}" alt="" onerror="this.src='img/default_user_v3.png'" class="userPhoto" />
          </a>
        </span>
        <span id="pinIcon" ng-if="thisPost.pin == true">
          <img src="img/pin.png" />
        </span>
      </span>
      <div id="socialHeader">
        <span class="socialPostUsername">
          {{thisPost.postAuthorName}}
        </span>
        <span class="timestamp">
          <img id="providerLogo" src="{{thisPost.providerLogo}}" />{{thisPost.postTimestamp}}
        </span>
      </div>
      <div class="socialAlias">
        @{{thisPost.postAuthorAlias}}
      </div>
    </div>
    <div class="socialContentContainer">
      <div ng-bind-html="thisPost.html | linky" class="postContent socialContent">
        <p>{{thisPost.html}}</p><br> 
      </div>
      <div ng-if="thisPost.embedPlayable === true" ng-bind-html="thisPost.embedHtml" class="postContent socialContent">
      </div>

      <!-- <div ng-switch-when="image" class="cropView ng-style:{ 'max-width': thisPost.mediaAspectFeed.w, 'max-height': thisPost.mediaAspectFeed.dispY };"> -->
      <div ng-switch-when="image" class="cropView" ng-style="{background:'url({{thisPost.mediaUrl}}) no-repeat','background-size':'cover','height':thisPost.mediaAspectFeed.h, 'margin-bottom':'15px'}" ng-click="imageClick(thisPost.mediaUrl)">
      <!-- <div ng-switch-when="image" class="cropView ng-style:{ '-webkit-clip-path': 'polygon(100% 100%, 100% 16px, 0% 16px, 0% 100%)' };"> -->
        <!-- <img ng-src="{{thisPost.mediaUrl}}" class="postPhotoSocial ng-style:{ bottom: thisPost.mediaAspectFeed.y, right: thisPost.mediaAspectFeed.x };" ng-click="imageClick(thisPost.mediaUrl);" /> -->
      </div>

      <div ng-switch-when="video" class="ng-style:{'margin-bottom':'15px'};">
        <video controls="controls" poster="{{thisPost.mediaThumbUrl}}" class="postVideo">
          <source ng-src="{{trustSrc(thisPost.mediaUrl)}}" type="video/mp4">
          </video>
      </div> 
    </div> 

    <div class="socialButtonsRow socialText">
      
      <button class="btn-link social-btn" ng-click="">
        <img class="social-metrics-reply" src="img/reply@2x.png"/>
      </button>
      <!-- <span class="socialButtonLable"> {{thisPost.replyCount}}</span> -->

      <button class="btn-link social-btn socialRetweet" ng-click="">
        <!-- <img class="social-metrics-retweet" ng-switch-when="true" src="img/retweet_select@2x.png"/>  -->
        <img class="social-metrics-retweet" src="img/retweet@2x.png" /> 
      </button>
      <span class="socialButtonLable">{{thisPost.retweetCount}}</span>

      <button class="btn-link social-btn socialFavorite" ng-click="">
        <!-- <img class="social-metrics-heart" ng-switch-when="true" src="img/heart_select@2x.png"/> --> 
        <img class="social-metrics-heart" src="img/heart@2x.png" /> 
      </button>
      <span class="socialButtonLable">{{thisPost.favoriteCount}}</span>

    </div>
  </div>

</div>

<div id="mobileUserInput" class="clearfix" ng-if="activeTab === 'chat' && mobileBrowser === true" ng-controller="UserInputController as user">

    <div id="mobilePreview" ng-if="user.uploader.queue.length > 0">
      <button type="button" id="removeMedia" class="fkFont" ng-click="user.removeMedia()">X
      </button>
    </div>
    <div id="mobileUploadControls" ng-if="user.uploader.isUploading && user.uploader.queue.length > 0">
      <div class="progress mobileProgress">
        <div id="progress-bar" role="progressbar" ng-style="{ 'width': user.uploader.progress + '%' }"></div>
      </div>
    </div>
    <form id="mobilePostCommentForm" ng-submit="user.postComment(commentText,true)">
      <div id="mobilePostCommentDiv" class="input-group">
        <label for="fileUpload" id="attachMediaIcon">
          <img src="img/attach-media.png" />
        </label>

        <button id="postCommentButton" class="btn btn-default" type="button" ng-click="user.postComment(commentText,true)">Post</button>

        <span><input id="topicCommentField" type="text" class="form-control"
        placeholder="Write a comment..." ng-model="commentText" ng-focus="user.highlightPost()" ng-blur="user.unhighlightPost()"></span>

        <input id="fileUpload" filestyle="" type="file" data-button-text="Single" data-class-button="btn btn-default" data-class-input="form-control inline" nv-file-select="" uploader="user.uploader" class="form-control" />

      </div>
    </form>
    <div class="fileWarning" ng-if="user.fileMaxExceeded" ng-switch="user.mediaType">
      <span class="text-danger" ng-switch-when="image">Image Max Size Exceeded: Please ensure file is less than 5MB</span>
      <span class="text-danger" ng-switch-when="video">Video Max Size Exceeded: Please ensure file is less than 10MB</span>
    </div>
    <div class="fileWarning" ng-if="user.HTML5warning === true">
      <span class="text-danger">Please Use a Browser That Supports HTML5</span>
    </div>
  </div>

</section>

<div id="newCommentsAvailableIndicatorDiv" ng-show="showNewCommentsIndicator && activeTab === 'chat'">
  <center>
    <button id="newCommentsAvailableIndicatorButton" class="btn-link" ng-click="newCommentsIndicatorTapped()"><img src="img/newCommentIndicator.png"/></button>
  </center>
</div>


